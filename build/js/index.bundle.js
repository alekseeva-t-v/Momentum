!function(){"use strict";let e;e=localStorage.settings?JSON.parse(localStorage.getItem("settings")):{language:"en",photoSource:"github",tags:[],blocks:["time","date","greeting","quote","weather","audio","todolist"]};var t=e,n={body:document.querySelector("body"),settingsBtn:document.querySelector(".settings__header"),settingsBlock:document.querySelector(".settings__block"),settingsWrapper:document.querySelector(".settings__wrapper"),radioLangList:document.querySelectorAll(".radio-lang"),radioBg:document.querySelectorAll(".radio-bg"),radioGithub:document.getElementById("github"),radioUnsplash:document.getElementById("unsplash"),radioFlickr:document.getElementById("flickr"),inputTag:document.getElementById("tag"),addTagBtn:document.getElementById("add-tag"),tagList:document.querySelector(".tag-list"),checkWeather:document.getElementById("check-weather"),checkTime:document.getElementById("check-time"),checkDate:document.getElementById("check-date"),checkGreetings:document.getElementById("check-greetings"),checkQuote:document.getElementById("check-quote"),checkTodo:document.getElementById("check-todo"),weatherBlock:document.querySelector(".weather"),weatherIcon:document.querySelector(".weather-icon"),weatherDescription:document.querySelector(".weather-description"),temperature:document.querySelector(".temperature"),wind:document.querySelector(".wind"),humidity:document.querySelector(".humidity"),city:document.querySelector(".city"),weatherError:document.querySelector(".weather-error"),timeBlock:document.querySelector(".time-block"),time:document.querySelector(".time"),date:document.querySelector(".date"),greetingContainer:document.querySelector(".greeting-container"),greeting:document.querySelector(".greeting"),name:document.querySelector(".name"),preloader:document.querySelector("#preloader"),slideNext:document.querySelector(".slide-next"),slidePrev:document.querySelector(".slide-prev"),quoteWrapper:document.querySelector(".quote__wrapper"),quote:document.querySelector(".quote"),author:document.querySelector(".author"),changeQuote:document.querySelector(".change-quote"),todoWrapper:document.querySelector(".todo__wrapper")},o=function(){localStorage.setItem("settings",JSON.stringify(t))},a=e=>e>=6&&e<12?"morning":e>=12&&e<17?"afternoon":e>=17&&e<24?"evening":"night",r=function(e,n,a){e.checked?(n.classList.remove("hide"),t.blocks.push(a),o()):(n.classList.add("hide"),t.blocks.forEach(((e,n)=>{e===a&&t.blocks.splice(n,1)})),o())},c=function(){const{timeBlock:e,time:o,date:c,greetingContainer:i,greeting:l,name:s,preloader:d,checkTime:u,checkDate:g,checkGreetings:m}=n;let h=window.location.hash.substr(1);t.blocks.includes("time")||(u.checked=!1,r(u,o,"time")),t.blocks.includes("date")||(g.checked=!1,r(g,c,"date")),t.blocks.includes("greeting")||(m.checked=!1,r(m,i,"greeting")),s.addEventListener("change",(function(){s.value.trim().length&&localStorage.setItem("name",s.value)})),window.addEventListener("load",(function(){localStorage.getItem("name")&&(s.value=localStorage.getItem("name"))})),setInterval(function(e){const t=new Date,n=t.getHours(),r=t.toLocaleTimeString(),i={weekday:"long",month:"long",day:"numeric"};c.textContent="en"===e?(new Date).toLocaleDateString("en-US",i):(new Date).toLocaleDateString("ru",i),o.textContent=r,l.textContent="en"===e?`Good ${a(n)},`:`${(e=>e>=6&&e<12?"Доброе утро":e>=12&&e<17?"Добрый день":e>=17&&e<24?"Добрый вечер":"Доброй ночи")(n)},`,s.placeholder="en"===e?"Your name":"Ваше имя"}(h),1e3),setTimeout((function(){d&&d.remove(),e.style.display="flex"}),1e3),u.addEventListener("change",(()=>{r(u,o,"time")})),g.addEventListener("change",(()=>{r(g,c,"date")})),m.addEventListener("change",(()=>{r(m,i,"greeting")}))},i=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),l=function(){let e=window.location.hash.substr(1);const{weatherBlock:o,weatherIcon:a,weatherDescription:c,weatherError:i,temperature:l,wind:s,humidity:d,city:u,checkWeather:g}=n;async function m(){const t=`https://api.openweathermap.org/data/2.5/weather?q=${u.value}&lang=${e}&appid=34a8094155f7b4c99e972c8d19d77c1a&units=metric`;try{const n=await fetch(t);if(!n.ok)throw new Error("Something went wrong. Check if the query you entered is correct...");const o=await n.json();n.ok&&(a.className="weather-icon owf",a.classList.add(`owf-${o.weather[0].id}`),l.textContent=`${o.main.temp.toFixed(0)}°C`,c.textContent=o.weather[0].description,s.textContent="en"===e?`Wind speed: ${o.wind.speed.toFixed(0)} m/s`:`Скорость ветра: ${o.wind.speed.toFixed(0)} м/с`,d.textContent="en"===e?`Humidity: ${o.main.humidity} %`:`Влажность: ${o.main.humidity} %`,i.textContent="")}catch(e){a.className="weather-icon owf",i.textContent=e.message,l.textContent="",c.textContent="",s.textContent="",d.textContent=""}}u.placeholder="en"===e?"Your city":"Ваш город",localStorage.getItem("city")||(u.value="en"===e?"Moscow":"Москва"),t.blocks.includes("weather")||(g.checked=!1,r(g,o,"weather")),m(),u.addEventListener("change",(function(){m(),""===i.textContent&&localStorage.setItem("city",u.value)})),g.addEventListener("change",(()=>{r(g,o,"weather")})),window.addEventListener("load",(function(){localStorage.getItem("city")&&(u.value=localStorage.getItem("city"))}))},s=function(){let e=window.location.hash.substr(1);const{quoteWrapper:o,quote:a,author:c,changeQuote:l,checkQuote:s}=n;async function d(e){const t=`./files/json/quote-${e}.json`;try{const e=await fetch(t);if(!e.ok)throw new Error("Something went wrong...");const n=await e.json(),o=i(0,n.length-1);a.innerText=n[o].text,c.innerText=n[o].author}catch{o.textContent=""}}t.blocks.includes("quote")||(s.checked=!1,r(s,o,"quote")),s.addEventListener("change",(()=>{r(s,o,"quote")})),window.addEventListener("load",d(e)),l.addEventListener("click",(()=>d(e)))},d=[{songName:"Moonlight Sonata",artist:"Paul Pitman",src:"music-1"},{songName:"Nocturne in B flat minor",artist:"Eduardo Vinuela",src:"music-2"},{songName:"Cello Suite no. 1",artist:"Accou",src:"music-3"},{songName:"Sonata 5 (II) Allegro",artist:"Telemann Trio",src:"music-4"},{songName:"Etude Op. 25 no. 1",artist:"Donald Betts",src:"music-5"},{songName:"Greensleeves to a Ground",artist:"Ariel Martin Bellio",src:"music-6"},{songName:"Twelve Spanish Dances, Op. 37",artist:"Monica Alianello",src:"music-7"}];location.href=`${window.location.pathname}#${t.language}`;const u={copy:{ru:"Алексеева Татьяна",en:"Alekseeva Tatyana"},settings:{ru:"Настройки",en:"Settings"},language:{ru:"Язык",en:"Language"},english:{ru:"английский",en:"english"},russian:{ru:"русский",en:"russian"},bg:{ru:"Источник фонового изображения",en:"Source for background image"},tag:{ru:"Тег фонового изображения",en:"Background image tag"},"show-block":{ru:"Показать / Скрыть блок",en:"Show / Hide block"},player:{ru:"Аудиоплеер",en:"Audio player"},weather:{ru:"Погода",en:"Weather"},time:{ru:"Время",en:"Time"},date:{ru:"Дата",en:"Date"},greetings:{ru:"Приветствие",en:"Greetings"},todo:{ru:"Список дел",en:"ToDoList"},quote:{ru:"Цитата",en:"Quote"}},{body:g,settingsBtn:m,settingsBlock:h,settingsWrapper:p,radioLangList:y,inputTag:f}=n;function k(){location.href=`${window.location.pathname}#${t.language}`}function S(){for(let e in u)document.querySelectorAll(`.lng-${e}`).forEach((n=>{n&&(n.innerHTML=u[e][t.language])}));f.placeholder="en"===t.language?"Enter tag":"Введите тег"}k(),S(),c(),function(){const{body:e,slideNext:r,slidePrev:c,radioBg:l,radioGithub:s,radioUnsplash:d,radioFlickr:u,inputTag:g,addTagBtn:m,tagList:h}=n;let p=0,y=0;function f(t){const n=new Image;n.src=t,n.addEventListener("load",(()=>{e.style.backgroundImage=`url(${n.src})`}))}function k(){const e=(new Date).getHours();return a(e)}function S(){let e="";const n=k();if(t.tags.length){const n=i(0,t.tags.length-1);e=t.tags[n]}"flickr"===t.photoSource?(t.tags.length?v(e,i(0,y-1)):v(n,i(0,y-1)),g.disabled=!1):"unsplash"===t.photoSource?(t.tags.length?w(e):w(n),g.disabled=!1):(_(String(i(1,20)).padStart(2,"0")),g.disabled=!0)}function _(e){const n=k();p=e,f(`./img/${n}/${e}.jpg`),t.tags=[],o(),h.textContent=""}async function w(e){const t=`https://api.unsplash.com/photos/random?query=${e}&client_id=S_pba8IuJJN66g2ksU6QyPjM-6gDhbhsbozGYDpdlag`,n=await fetch(t);f(`${(await n.json()).urls.regular}`)}async function v(e,t){const n=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=4ad25702fc121fbc517f23809559c8b4&tags=${e}&extras=url_l&format=json&nojsoncallback=1`,o=await fetch(n),a=await o.json();y=a.photos.photo.length,f(`${a.photos.photo[t].url_l}`)}function E(e){const t=document.createElement("button");t.className="tag-item",t.textContent=e,h.append(t)}function L(){t.tags.forEach((e=>{E(e)}))}function q(){document.querySelectorAll(".tag-item").forEach((e=>{e.addEventListener("click",(n=>{n.preventDefault();const a=t.tags.filter((t=>t!==e.textContent));t.tags=a,h.textContent="",o(),L(),q(),S()}))}))}function b(){g.value.trim()&&!t.tags.includes(g.value.trim())?(t.tags.push(g.value.trim()),E(g.value.trim()),t.tags.push(g.value.trim()),t.tags=[...new Set(t.tags)],g.value="",q(),S()):g.value=""}"github"===t.photoSource&&(s.checked=!0),"unsplash"===t.photoSource&&(d.checked=!0),"flickr"===t.photoSource&&(u.checked=!0),t.tags.length&&(L(),q()),S(),r.addEventListener("click",(function(){"github"===t.photoSource?_(p<20?String(++p).padStart(2,"0"):String(p=1).padStart(2,"0")):S()})),c.addEventListener("click",(function(){"github"===t.photoSource?_(p>1?String(--p).padStart(2,"0"):String(p=20).padStart(2,"0")):S()})),l.forEach((e=>{e.addEventListener("change",(()=>{t.photoSource=e.id,o(),S()}))})),m.addEventListener("click",(e=>{e.preventDefault(),b(),o()})),g.addEventListener("keydown",(e=>{13===e.keyCode&&(e.preventDefault(),b(),o())}))}(),l(),s(),function(){const e=d,n=document.querySelector(".player"),o=document.querySelector(".player__controls-play"),a=document.querySelector(".player__controls-play-prev"),c=document.querySelector(".player__controls-play-next"),i=document.querySelector(".player__controls-play-list"),l=document.querySelector(".player__controls-sound-off"),s=document.querySelector(".player__progress-bar"),u=document.querySelector(".player__progress-area"),g=document.querySelector(".player__progress-current"),m=document.querySelector(".player__progress-duration"),h=document.querySelector(".player__artist"),p=document.querySelector(".player__song-name"),y=document.querySelector(".player__play-list"),f=document.getElementById("check-audio");t.blocks.includes("audio")||(f.checked=!1,r(f,n,"audio"));let k=!1,S=0,_=0;const w=new Audio;function v(){w.src=`./files/music/${e[S].src}.mp3`,w.currentTime=_,w.play(),k=!0,w.addEventListener("loadeddata",(()=>{let t=w.duration,n=Math.floor(t/60),o=Math.floor(t%60);o<10&&(o=`0${o}`),m.innerText=`${n}:${o}`,h.innerText=e[S].artist,p.innerText=e[S].songName})),function(){const e=b().find((e=>Number(e.dataset.id)===S)),t=e.querySelector(".player__controls-play--min");e.classList.add("player__play-item--active"),t.classList.add("player__controls-pause--min")}(),L()}function E(){w.pause(),_=w.currentTime,k=!1,b(),L()}function L(){k?o.classList.add("player__controls-pause"):o.classList.remove("player__controls-pause")}function q(){S=S<e.length-1?S+1:0,_=0,v()}function b(){const e=Array.from(document.querySelectorAll(".player__play-item")),t=Array.from(document.querySelectorAll(".player__controls-play--min"));return e.forEach((e=>{e.classList.remove("player__play-item--active")})),t.forEach((e=>{e.classList.remove("player__controls-pause--min")})),e}e.forEach(((e,t)=>{const n=document.createElement("li");n.classList.add("player__play-item"),n.dataset.id=t,n.innerHTML=`<button class="player__controls-icon player__controls-play--min player__controls-icon--min"></button>\n      <span>${e.artist} - ${e.songName}</span>`,y.append(n)})),Array.from(document.querySelectorAll(".player__controls-play--min")).forEach((e=>{e.addEventListener("click",(()=>{const t=e.closest(".player__play-item");k?k&&Number(t.dataset.id)===S?E():(E(),S=Number(t.dataset.id),_=0,v()):(S=Number(t.dataset.id),v())}))})),w.addEventListener("timeupdate",(e=>{const t=e.target.currentTime;let n=t/e.target.duration*100;s.style.width=`${n}%`;let o=Math.floor(t/60),a=Math.floor(t%60);a<10&&(a=`0${a}`),g.innerText=`${o}:${a}`})),o.addEventListener("click",(function(){k?E():v()})),c.addEventListener("click",q),a.addEventListener("click",(function(){S=S>0?S-1:e.length-1,_=0,v()})),w.addEventListener("ended",q),i.addEventListener("click",(e=>{y.classList.toggle("player__play-list--active")})),n.addEventListener("click",(e=>{e._isClickWithInPlayList=!0})),document.body.addEventListener("click",(e=>{e._isClickWithInPlayList||y.classList.remove("player__play-list--active")})),u.addEventListener("click",(e=>{let t=u.clientWidth,n=e.offsetX,o=w.duration;_=n/t*o,v()})),l.addEventListener("click",(()=>{w.muted=!w.muted,l.classList.toggle("player__controls-sound-on"),l.classList.toggle("player__controls-sound-off")})),f.addEventListener("change",(()=>{r(f,n,"audio")}))}(),function(){const{todoWrapper:e,checkTodo:o}=n;t.blocks.includes("todo")||(o.checked=!1,r(o,e,"todo")),o.addEventListener("change",(()=>{r(o,e,"todo")}))}(),y.forEach((e=>{e.id===t.language&&(e.checked=!0)})),y.forEach((e=>{e.addEventListener("click",(()=>{t.language=e.id,k(),o(),c(),l(),s(),S()}))})),m.addEventListener("click",(()=>{h.classList.toggle("settings__block--active")})),p.addEventListener("click",(e=>{e._isClickWithInSettingsBlock=!0})),g.addEventListener("click",(e=>{e._isClickWithInSettingsBlock||h.classList.remove("settings__block--active")}))}();